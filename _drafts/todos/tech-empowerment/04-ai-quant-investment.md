# 🤖 AI辅助DCA策略开发教程

## 📚 教程目标

教你如何使用Claude/ChatGPT等AI工具，零基础改进DCA策略，实现个性化定制。

## 🎯 适合人群

- 不懂编程的投资者
- 想优化策略的用户
- 希望学习量化的新手

## 🛠️ 准备工作

### 1. 选择AI助手
- **Claude** (推荐)：代码能力强，可处理长文本
- **ChatGPT**：通用性好，交互友好
- **通义千问**：免费，中文友好

### 2. 准备材料
- DCA策略源代码 (`dca_free_version.quant`)
- Moomoo API文档 (`Moomoo量化功能中常用的API函数及其用法.txt`)
- 你的需求描述

## 📖 基础教程

### 第一课：添加断点续传功能

#### Step 1: 向AI提供背景
```
我有一个Moomoo量化平台的DCA定投策略，使用Python编写。
现在想添加断点续传功能，即策略重启后能恢复之前的持仓状态。

这是策略代码：
[粘贴dca_free_version.quant内容]

这是可用的API函数：
position_holding_qty(symbol) - 获取持仓数量
position_cost(symbol, CostPriceModel.AVG) - 获取平均成本
```

#### Step 2: 提出具体需求
```
请帮我修改initialize函数，添加以下功能：
1. 策略启动时检查是否有现有持仓
2. 如果有持仓，恢复持仓数量和成本
3. 打印恢复信息
```

#### Step 3: 获得代码并理解
AI会返回类似这样的代码：
```python
def initialize(self):
    # ... 原有代码 ...
    
    # 恢复持仓状态
    try:
        existing_qty = position_holding_qty(self.stock)
        if existing_qty > 0:
            self.position_qty = existing_qty
            avg_cost = position_cost(self.stock, CostPriceModel.AVG)
            if avg_cost > 0:
                self.total_cost = avg_cost * existing_qty
                print("📌 检测到现有持仓: {0}股 @ 平均成本${1:.2f}".format(
                    existing_qty, avg_cost))
    except:
        pass  # 如果查询失败，使用默认值
```

#### Step 4: 集成测试
1. 将修改后的代码保存
2. 在模拟账户测试
3. 验证功能是否正常

### 第二课：调整投资频率

#### 需求描述
```
我想把策略从每周投资改为每日投资，请帮我修改相关代码。
注意保持其他功能不变。
```

#### AI会指导你修改
```python
# 修改1：调整时间间隔
self.interval_days = 1  # 从7改为1

# 修改2：更新提示信息
print("   • 投资频率: 每日定投")  # 从"每周"改为"每日"
```

### 第三课：增加回撤层级

#### 复杂修改示例
```
我想增加回撤层级，从3层改为5层：
- 原来：5%, 10%, 20%
- 新的：5%, 10%, 15%, 25%, 40%
- 对应倍数：1.2, 1.5, 2.0, 3.0, 4.0
```

#### AI提供完整方案
```python
# 修改回撤系统配置
self.drawdown_layers = [5.0, 10.0, 15.0, 25.0, 40.0]      # 5层回撤阈值
self.drawdown_multipliers = [1.2, 1.5, 2.0, 3.0, 4.0]     # 对应加仓倍数

# 注意：免费版提示信息也要更新
print("   • 回撤保护: 5层智能加仓")  # 从"3层"改为"5层"
```

## 🚀 进阶技巧

### 1. 让AI解释代码
```
请解释这段代码的作用：
[粘贴代码片段]
```

### 2. 让AI优化性能
```
这段代码运行很慢，请帮我优化：
[粘贴代码]
```

### 3. 让AI添加功能
```
我想添加一个功能：当亏损超过20%时发送提醒
请提供实现方案
```

### 4. 让AI修复错误
```
运行时报错：[错误信息]
这是相关代码：[代码]
请帮我修复
```

## 💡 最佳实践

### DO 应该做的
✅ 提供完整上下文
✅ 描述清楚需求
✅ 先在模拟环境测试
✅ 逐步修改，每次一个功能
✅ 保存原始版本备份

### DON'T 不应该做的
❌ 一次修改太多功能
❌ 不测试就用于实盘
❌ 完全依赖AI不理解代码
❌ 忽略错误提示
❌ 修改核心交易逻辑

## 📋 常用AI提示词模板

### 模板1：功能添加
```
我有一个Moomoo量化平台的DCA策略，想添加[具体功能]。

当前代码：
[代码]

可用API：
[API函数]

请提供修改方案。
```

### 模板2：参数调整
```
请帮我修改DCA策略的参数：
- 原参数：[原值]
- 新参数：[新值]
- 注意事项：[特殊要求]

代码：[相关代码]
```

### 模板3：错误修复
```
DCA策略运行报错：
错误信息：[错误]
错误位置：[代码行]
相关代码：[代码]

请帮我分析原因并修复。
```

## 🎓 学习路线图

```
第1周：熟悉AI工具
  ├── 注册Claude/ChatGPT
  ├── 学习基本对话
  └── 理解代码结构

第2周：简单修改
  ├── 调整参数
  ├── 修改提示信息
  └── 测试验证

第3-4周：功能添加
  ├── 断点续传
  ├── 统计增强
  └── 条件优化

第2月：深度定制
  ├── 多标的支持
  ├── 风控机制
  └── 性能优化
```

## 🔧 实用工具

### 代码对比工具
- 在线：DiffChecker.com
- 本地：VS Code对比功能

### 测试记录表
```
| 日期 | 修改内容 | 测试结果 | 备注 |
|-----|---------|---------|------|
| 2025-01-15 | 添加断点续传 | ✅ 成功 | 恢复持仓正常 |
| 2025-01-16 | 改为日投 | ✅ 成功 | 频率正确 |
```

## ❓ 常见问题

**Q: AI不理解我的需求怎么办？**
A: 提供更多上下文，使用具体例子说明

**Q: 修改后策略不运行怎么办？**
A: 检查缩进、语法错误，让AI帮你调试

**Q: 如何验证修改是否正确？**
A: 先打印日志验证，再小资金测试

## 📚 推荐资源

- [Moomoo API文档](本地文档)
- [Python基础教程](https://www.runoob.com/python/python-tutorial.html)
- [Claude使用技巧](https://www.anthropic.com/claude)

## 🎯 下一步

1. 选择一个简单修改开始
2. 按照教程与AI对话
3. 测试验证修改效果
4. 在群里分享你的成果

---

**记住：使用AI是为了提高效率，但理解代码才能真正掌控策略！**

有问题随时在群里提问，让我们一起进步！