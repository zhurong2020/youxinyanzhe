---
author_profile: true
breadcrumbs: true
categories:
- 技术赋能
- 认知升级
comments: true
date: 2025-09-24 10:30:00
excerpt: 授人以鱼不如授人以渔。通过教练式提问，引导你理解定投策略核心，掌握改造方法，实现从使用者到创造者的蜕变。
header:
  overlay_filter: 0.5
  overlay_image: assets/images/posts/2025/09/strategy-modification-cover.png
  teaser: assets/images/posts/2025/09/strategy-modification-teaser.png
last_modified_at: '2025-09-24 11:00:00'
layout: single
related: true
share: true
title: 开源定投策略改造指南：从使用者到创造者
toc: true
toc_icon: list
toc_label: 本页内容
toc_sticky: true
---

授人以鱼不如授人以渔。本文不会直接给你代码，而是通过一系列思考题，引导你自主探索、理解和改造策略。从突破限制到个性化设计，让我们一起踏上从使用者到创造者的进阶之路。

<!-- more -->

## 🎧 音频版本

如果您更喜欢收听而非阅读，我们提供了本文的音频版本：

📹 **YouTube播客**：[点击收听](https://youtu.be/example){:target="_blank"}
⏱️ **时长**：约20分钟
🎯 **适合场景**：通勤路上、运动时、做家务时

---

## 系列文章导航

本文是TQQQ定投策略系列的第3篇（完结篇）：
- 第1篇：[回测分析——从-60%回撤到盈利](https://zhurong2020.github.io/youxinyanzhe/posts/2025/09/from-60-percent-drawdown-to-profit-turnaround/){:target="_blank"}
- 第2篇：[TQQQ定投深度剖析：为什么周投能赢日投？](https://zhurong2020.github.io/youxinyanzhe/posts/2025/09/tqqq-weekly-vs-daily-analysis/){:target="_blank"}
- **第3篇：开源定投策略改造指南**（本文）

---

## 引言：AI时代的策略改造新方法

在前两篇文章中，我们展示了定投策略的威力。但更重要的是：**如何高效地理解和改造策略**。

> "The best way to learn is to teach a machine to do it for you."
> — 现代量化投资者

**本文的核心方法**：
- ✅ 利用AI（Claude/ChatGPT）理解代码
- ✅ 在VS Code中借助AI改造策略
- ✅ 通过提问引导思考方向
- ✅ 让AI成为你的编程助手

**推荐阅读**：
- [智能投资指南：手把手教你用量化工具定投美股](https://zhurong2020.github.io/post/zhi-neng-tou-zi-zhi-nan-shou-ba-shou-jiao-ni-yong-liang-hua-gong-ju-ding-tou-mei-gu/){:target="_blank"}
- [打造你的第一个量化交易机器人-Moomoo平台环境搭建指南](https://zhurong2020.github.io/post/da-zao-ni-de-di-yi-ge-liang-hua-jiao-yi-ji-qi-ren-moomoo-ping-tai-huan-jing-da-jian-zhi-nan/){:target="_blank"}

## 1. 理解Moomoo量化框架

### 1.1 平台准备与框架理解

> ⚠️ **开户提醒**：
> - 目前Moomoo等券商已收紧新用户开户要求
> - 开户时可能需要提供国外身份证明
> - 建议先确认开户资格再进行学习
>
> 📚 **版本选择**：
> - 推荐使用**Moomoo Windows Legacy版本**
> - 下载时选择带有Legacy标记的版本（如Ver.15.33.19958）
> - Legacy版本量化功能更稳定

**第一步：理解框架结构**

打开Moomoo量化功能，点击右上角"查看量化文档"，了解基本框架。然后：

1. **把免费版代码复制到VS Code**
2. **安装Claude或Cursor插件**（推荐Cursor，内置AI功能）
3. **让AI解释代码结构**

**与AI的对话示例**：
```
你："请解释这个Moomoo策略的整体结构"
AI："这个策略包含三个层面：基础框架函数（initialize和handle_data）..."

你："为什么类名必须是Strategy？"
AI："这是Moomoo平台的硬性要求，系统会查找名为Strategy的类..."
```

### 1.2 AI辅助理解核心概念

**高效学习方法**：

1. **复制关键函数给AI分析**：
```
你："trigger_symbols()函数是做什么的？最多可以设置几个？"
AI："这个函数定义运行标的，最多可以设置8个..."
```

2. **让AI生成注释版代码**：
```
你："请为这段代码添加详细的中文注释"
AI："好的，我来为每个函数添加注释说明..."
```

3. **询问最佳实践**：
```
你："initialize()中不应该放什么代码？"
AI："不建议放过多逻辑，因为会影响策略启动速度..."
```

> 💎 **完整版福利**：
> 购买完整版的用户将获得：
> - 📄 《Moomoo量化策略框架具体说明》整理版
> - 📄 《Moomoo量化功能常用API函数及其用法》（46个常用函数详解）
> - 📖 **AI改造提示词模板集**（10个场景的最佳提问方式）
> - 避免走弯路，节省大量查找时间

## 2. AI辅助改造实战

### 2.1 工作流程：VS Code + AI

**推荐工具组合**：
- **编辑器**：VS Code 或 Cursor（内置AI）
- **AI助手**：Claude 3.5 Sonnet 或 GPT-4
- **版本管理**：Git（保存每次修改）

**标准工作流程**：
1. 在VS Code中打开策略代码
2. 选中要修改的部分
3. 询问AI如何改造
4. 让AI生成修改后的代码
5. 在Moomoo中测试回测

### 2.2 改造案例1：突破股数限制

**与AI的对话示例**：

```
你："我想突破单次10股的限制，如何修改？"
AI："找到MAX_SHARES_PER_ORDER变量，可以这样改..."

你："能否根据账户资金动态调整？"
AI："可以使用total_cash()函数获取资金，这里是代码..."

你："请生成完整的修改版本"
AI："好的，这是修改后的global_variables()函数..."
```

**AI提示词技巧**：
- 明确说明当前版本和期望结果
- 提供相关的API函数名
- 要求AI解释修改原理

### 2.3 改造案例2：修改投资频率

**有效的提问方式**：

```
你："当前是每7天投资一次，我想改成每天投资，
     并且只在工作日执行，请修改代码"

AI："我来帮你实现这个功能：
     1. 修改interval_days为1
     2. 添加工作日判断逻辑
     3. 使用device_time()获取当前时间..."
```

### 2.4 改造案例3：智能化升级

**复杂需求的处理**：

```
你："我想添加一个功能：当VIX>30时每天投资，
     VIX<20时每周投资，如何实现？"

AI："这需要添加VIX获取和动态调整逻辑，
     但Moomoo可能不支持直接获取VIX，
     可以用以下替代方案..."
```

## 3. 进阶改造：AI帮你优化策略

### 3.1 让AI设计回撤系统

**高级提示词示例**：

```
你："我投资TQQQ，当前回撤层级是[5%, 15%, 20%]，
     对应倍数[1.2, 1.5, 1.8]。
     请根据TQQQ的历史波动特性，优化这个参数组合"

AI："根据TQQQ的高波动特性（年化波动率70%+），
     建议调整为：
     - 层级：[5%, 10%, 20%, 35%, 50%]
     - 倍数：[1.2, 1.5, 2.0, 3.0, 5.0]
     理由是..."
```

### 3.2 AI辅助风险管理

**让AI帮你检查风险**：

```
你："请检查我的策略是否有风险漏洞，
     特别是资金管理方面"

AI："我发现以下潜在风险：
     1. 没有检查available_fund()
     2. 深度回撤时可能资金耗尽
     3. 建议添加最大仓位限制..."
```

### 3.3 参数优化建议

**数据驱动的改造**：

```
你："基于2025年TQQQ从$90跌到$35的案例，
     如何优化参数让收益最大化？"

AI："根据这个60%的回撤案例，建议：
     1. 增加深度回撤层级（40%, 50%, 60%）
     2. 在$40以下大幅加仓
     3. 保留20%应急资金..."
```

## 4. 回测验证：让AI帮你分析

### 4.1 AI辅助回测设计

**让AI制定回测计划**：

```
你："我修改了定投策略，请帮我设计回测方案"

AI："建议以下回测计划：
     1. 时间段：2020疫情、2022熊市、2025暴跌
     2. 对比指标：收益率、最大回撤、夏普比率
     3. 资金规模：$5k、$20k、$50k
     4. 至少测试3个不同参数组合..."
```

### 4.2 结果分析与优化

**AI解读回测数据**：

```
你："原版收益36%，回撤16%；
     改版收益45%，回撤22%。值得吗？"

AI："从风险收益比看：
     - 原版夏普比率：2.25
     - 改版夏普比率：2.05
     虽然收益提升，但风险调整后收益略降...
     建议：保持中等仓位时使用改版..."
```

### 4.3 持续优化循环

**迭代改进流程**：
1. 修改策略 → 2. 回测验证 → 3. AI分析结果 → 4. 优化参数 → 循环

## 5. AI提示词模板库

### 5.1 基础改造提示词

**修改参数**：
```
"当前[参数名]是[当前值]，我想改成[目标值]，
请修改代码并解释影响"
```

**添加功能**：
```
"我想添加[功能描述]，当[条件]时[动作]，
请提供实现代码"
```

### 5.2 分析优化提示词

**性能分析**：
```
"这段代码有性能问题吗？如何优化？"
```

**风险检查**：
```
"请检查这个策略的潜在风险，
特别是[资金管理/执行逻辑/边界条件]"
```

### 5.3 高级改造提示词

**智能升级**：
```
"如何让这个策略更智能？
比如根据市场状态自动调整参数"
```

**组合策略**：
```
"如何将定投策略与[网格/套利/其他]结合？"
```

## 6. 社区文化：共同成长

### 6.1 加入学习社区

**两个交流群体**：

🌟 **爱好者交流群**（免费版用户）
- 志同道合的量化爱好者
- 互相学习，共同进步
- 分享改造经验和心得
- 探讨策略优化思路

💎 **VIP专属群**（完整版用户）
- 更多专业量化投资者
- 作者不定期参与讨论
- 深度技术交流
- 优先获得新策略信息

> 📱 **加群方式**：
> - 评论区留言"加入爱好者群"或"加入VIP群"
> - 作者会主动联系您
> - 未来会建立Discord社区，提供更好的交流体验

### 6.2 正确的提问艺术

**在群里提问前，请先**：

1. **先问AI** (Claude/ChatGPT)
   - 让AI解释代码逻辑
   - 询问修改方案
   - 获取初步答案

2. **自己尝试** (至少30分钟)
   - 在VS Code中修改
   - 在Moomoo中回测
   - 记录错误信息

3. **搜索已有答案**
   - 群聊记录
   - Moomoo官方文档
   - 博客文章

4. **完整描述问题**
   ```
   环境：Moomoo Legacy版本 15.33
   目标：想实现按金额定投
   尝试：用AI生成了代码，但报错
   错误：TypeError: unsupported operand
   代码：[贴出相关代码片段]
   ```

5. **分享AI对话**
   - 展示你与AI的对话
   - 说明AI给出的方案
   - 解释为什么没成功

### 6.3 优秀的社区成员

**❌ 避免成为**：
- 伸手党："代码发我"、"怎么改成日投？"
- 急躁者："在吗？快回！急！"
- 只取不予者：只提问题，从不分享

**✅ 努力成为**：
- 探索者："我试了X方法，结果Y，可能是因为Z"
- 分享者："我发现了一个技巧，分享给大家"
- 帮助者："这个问题我遇到过，解决方法是..."
- 贡献者："我改进了策略，回测效果提升15%"

### 6.4 群规与文化

**核心原则**：
- 🤝 **互助**：帮助他人就是帮助自己
- 🧠 **思考**：先思考再提问
- 💡 **分享**：你的经验可能帮助很多人
- 🚀 **成长**：每天进步一点点

**禁止行为**：
- ❌ 发广告、拉人
- ❌ 讨论与量化无关内容
- ❌ 人身攻击、嘲讽他人
- ❌ 传播未经验证的策略

## 7. 学习路径建议

### 7.1 新手期（第1-2周）

**学习路径**：
1. **Day 1-3**：安装VS Code + AI插件
2. **Day 4-7**：让AI解释免费版代码
3. **Week 2**：完成第一个简单改造

**AI辅助学习**：
```
每天问AI一个问题：
"这个函数是做什么的？"
"这段代码的执行流程是？"
"如何修改这个参数？"
```

### 7.2 成长期（第3-4周）

**进阶实践**：
- 用AI生成新功能
- 让AI优化现有代码
- 请AI分析回测结果

**学习技巧**：
- 保存有用的AI对话
- 建立自己的提示词库
- 记录成功的改造案例

### 7.3 进阶期（第2个月）

**创新阶段**：
- 结合多个策略
- 开发独特功能
- 分享改造经验

**AI协作模式**：
```
你负责：策略思路、风险把控
AI负责：代码实现、bug修复
```

## 8. 资源获取

### 策略版本说明

**免费版策略**：
- 📦 完整功能的3层回撤系统
- 🆓 源码开放，自由改造
- 💡 适合学习和研究
- 🎯 满足90%投资需求

**完整版策略**（¥299）：
- 📖 7层深度加仓系统
- 📊 5年历史回测数据
- 📄 Moomoo文档整理版
- 👥 VIP专属交流群
- 🎯 一对一指导服务
- ♻️ 永久免费升级

> 获取方式：评论区留言"策略获取"

### 学习资源推荐

**基础知识**：
- Moomoo官方量化文档
- Python基础教程
- 量化投资入门书籍

**进阶学习**：
- 技术博客：zhurong2020.github.io
- YouTube策略讲解视频
- 经典量化策略论文

## 9. 写在最后

### AI时代的学习新范式

> "In the age of AI, the ability to ask the right questions is more valuable than knowing all the answers."

这个系列的核心价值：
- **学会与AI协作**，而非单打独斗
- **掌握提问技巧**，让AI成为助手
- **理解核心逻辑**，AI负责实现细节
- **快速迭代验证**，加速学习进程

### 三步成长路径

**第一步：AI辅助理解**（1-2周）
```
你提供：策略代码
AI输出：详细解释
你收获：深度理解
```

**第二步：AI辅助改造**（3-4周）
```
你提供：改造需求
AI输出：实现代码
你收获：定制策略
```

**第三步：AI辅助创新**（第2个月）
```
你提供：创新想法
AI输出：技术方案
你收获：独特策略
```

### 最后的提醒

> 🔔 **重要事项**：
> - **开户要求**：需要国外身份证明
> - **版本选择**：使用Legacy版本
> - **工具准备**：VS Code + AI插件
> - **策略运行**：每天手动启动

### 立即行动：你的第一个AI辅助改造

**10分钟快速开始**：

1. **打开VS Code**，粘贴免费版代码
2. **打开Claude.ai**（或ChatGPT）
3. **复制代码给AI**："请解释这个策略的工作原理"
4. **提出改造需求**："我想改成每天定投"
5. **测试AI的代码**：在Moomoo中回测

**第一个成功改造后**：
- 截图分享到群里
- 记录你的改造经验
- 帮助下一个新手

**记住**：AI是你的编程助手，你是策略的设计师！

---

## 系列总结

通过这个系列，我们完成了：
1. **数据验证**：-60%回撤后仍能盈利的真实案例
2. **原理剖析**：周投vs日投的数学逻辑
3. **能力培养**：从使用者到创造者的路径

**最重要的收获**：
- 不是策略本身
- 而是独立思考和解决问题的能力
- 这才是真正的财富

如果这个系列对你有帮助：
- 💬 分享你的学习心得
- ⭐ 推荐给需要的朋友
- 🎯 加入社区共同成长

让我们在量化投资的道路上携手前行！

---

**免责声明**：
- 本文仅供教育参考，不构成投资建议
- 策略改造风险自负
- 投资有风险，入市需谨慎

**作者简介**：前银行从业者，现专注于量化投资研究。坚信教育和分享的力量，致力于帮助普通投资者掌握科学的投资方法。

**#量化投资 #教练式学习 #开源精神 #社区文化 #TQQQ定投**


{% assign investment_tags = 'QDII基金,指数投资,标普500,纳斯达克100,定投策略,基金投资,股票投资,投资理财,量化交易,投资策略,风险管理,资产配置,投资心理,美股投资,ETF投资' | split: ',' %}
{% assign show_investment_disclaimer = false %}
{% for tag in page.tags %}
  {% if investment_tags contains tag %}
    {% assign show_investment_disclaimer = true %}
    {% break %}
  {% endif %}
{% endfor %}

{% if show_investment_disclaimer %}
---

**💭 学习分享声明**：这里记录的是我在投资理财学习路上的个人思考和实践心得。正如《金钱心理学》所言："每个人的情况不同"，投资决策需要结合您的具体情况、风险承受能力和投资目标。本文仅供学习交流，不构成投资建议，请保持独立思考，持续学习。

{% endif %}

如果你觉得我的文章对你有帮助，可以[请我喝咖啡](https://www.buymeacoffee.com/zhurong052Q)

<a href="https://www.buymeacoffee.com/zhurong052Q" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a>

> 💬 **发表评论**: 您需要有一个 GitHub 账号来发表评论。