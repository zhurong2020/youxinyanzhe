# run.py 菜单功能扩展说明

## 更新概览

已成功将项目中的独立功能脚本整合到 `run.py` 主菜单中，提供统一的访问入口和用户友好的界面。

## 新增菜单结构

### 主菜单布局
```
📝 有心言者 - 内容发布系统
==================================================
📝 内容发布：
1. 处理现有草稿
2. 重新发布已发布文章  
3. 生成测试文章

🛠️ 系统工具：
4. 内容变现管理
5. 系统状态检查
6. 文章更新工具
7. 调试和维护工具

0. 退出
```

## 功能详解

### 4. 内容变现管理 💰
**整合脚本**: `reward_system_manager.py`, `github_release_manager.py`, `email_sender.py`

**功能说明**：
- 管理文章的内容变现包创建和发送
- 查看和管理奖励系统状态
- 发送内容包给打赏用户

**前提条件**：
- 需要配置GitHub Token (用于Release创建)
- 需要配置邮件服务器 (用于发送奖励)
- 确保相关环境变量已设置

**子菜单选项**：
1. 为文章创建内容变现包
2. 查看奖励发送状态
3. 手动发送奖励给用户
4. 运行奖励系统测试

### 5. 系统状态检查 🔍
**整合脚本**: `wechat_system_verify.py`, `check_github_token.py`

**功能说明**：
- 检查微信发布系统状态和输出文件
- 检查GitHub Token有效性和过期时间
- 验证系统各组件工作状态

**子菜单选项**：
1. 微信系统状态检查
2. GitHub Token状态检查
3. 综合系统检查

### 6. 文章更新工具 📝
**整合脚本**: `update_post.py`

**功能说明**：
- 更新已发布的文章内容
- 支持两种模式：直接编辑或完整处理流程
- 自动处理Git提交

**使用说明**：
- 文章名称需包含日期前缀 (YYYY-MM-DD-)
- 工具会自动查找匹配的文章文件
- 支持直接编辑模式和流水线处理模式

**子菜单选项**：
1. 更新已发布文章 (直接编辑模式)
2. 更新已发布文章 (流水线处理模式)
3. 查看文章更新帮助

### 7. 调试和维护工具 🔧
**整合脚本**: `wechat_api_debug.py`, `test_reward_system.py`, 测试套件

**功能说明**：
- 微信API调试和测试工具
- 系统组件验证和故障排查
- 开发和维护专用工具

**注意事项**：
- 这些工具主要用于开发和调试
- 某些功能需要开发者权限
- 使用前请确保了解工具功能

**子菜单选项**：
1. 微信API调试工具
2. 运行项目测试套件
3. 查看系统日志
4. 清理临时文件

## 技术实现特点

### 1. 用户友好的界面
- 每个功能都有详细的说明和前提条件提示
- 清晰的菜单层次结构
- 统一的操作反馈

### 2. 安全的脚本执行
- 使用 `subprocess.run()` 安全执行外部脚本
- 捕获并显示脚本输出和错误信息
- 适当的权限确认提示

### 3. 完整的日志记录
- 所有用户操作都记录到系统日志
- 便于问题追踪和使用分析

### 4. 灵活的返回机制
- 所有子功能执行完毕后自动返回主菜单
- 支持用户随时退出或切换功能

## 集成的脚本清单

### 已整合脚本
- ✅ `scripts/utils/reward_system_manager.py` - 内容变现系统管理
- ✅ `scripts/utils/github_release_manager.py` - GitHub Release管理  
- ✅ `scripts/utils/email_sender.py` - 邮件发送系统
- ✅ `scripts/tools/wechat_api_debug.py` - 微信API调试
- ✅ `scripts/tools/wechat_system_verify.py` - 微信系统验证
- ✅ `scripts/tools/check_github_token.py` - GitHub Token检查
- ✅ `scripts/update_post.py` - 文章更新工具
- ✅ `scripts/tools/test_reward_system.py` - 奖励系统测试

### 核心功能脚本 (已在主流程中)
- `scripts/core/content_pipeline.py` - 内容处理核心
- `scripts/core/wechat_publisher.py` - 微信发布核心
- `scripts/utils/package_creator.py` - 内容打包工具 (通过reward_system_manager调用)

## 使用建议

1. **首次使用**: 建议先运行"系统状态检查"确保环境配置正确
2. **日常使用**: 原有的内容发布功能保持不变，新增的工具功能提供更好的管理体验
3. **开发调试**: 使用"调试和维护工具"进行问题排查和系统维护
4. **内容变现**: 通过"内容变现管理"统一管理奖励系统和GitHub Release

## 兼容性说明

- 完全向后兼容原有功能
- 所有原有脚本仍可独立运行
- 新增功能为可选功能，不影响核心发布流程

---

**更新时间**: 2025-07-25  
**版本**: v2.0 - 统一工具菜单版本